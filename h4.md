# h4 Some Disassembly Required.

## Pöytäkoneen Ympäristö
- Windows 11
- CPU: AMD Ryzen 9 5700X 12-Core Processor
- RAM: 32GB
- GPU: Nvidia Geforce RTX 3070 8GB
- Disc size 2TB

## Virtuaalikoneen ympäristö

<img width="551" height="655" alt="image" src="https://github.com/user-attachments/assets/0947c51d-fa57-457f-ae23-86b63941ef0e" />

## Tiiviste

- Tässä videossa John Hammond katsoo tiedoston bbbbloat lähdekoodia käyttämällä Ghidra sovellusta. Hän analysoi ELF64 binääriä ja käyttää Ghidran decompiler toimintoja löytääkseen piilotettua tietoa lähdekoodista.

## a) Lataa Ghidra

- Tässä tehtävässä lataan Ghidran virtuaalikoneelleni.
<img width="1049" height="50" alt="image" src="https://github.com/user-attachments/assets/8bef6cc8-6d42-4b40-b75a-3857f9396c17" />
<img width="897" height="101" alt="image" src="https://github.com/user-attachments/assets/15631397-8400-43cb-bdca-8d8ce77a0bea" />
<img width="554" height="21" alt="image" src="https://github.com/user-attachments/assets/9b76bd75-9708-4c15-937b-aef7fd4903bb" />

- Testaan että Ghidra toimii kunnolla. 
<img width="705" height="20" alt="image" src="https://github.com/user-attachments/assets/81107b88-446e-422b-832c-d72005e0c99b" />
<img width="996" height="494" alt="image" src="https://github.com/user-attachments/assets/a8b04643-4780-4a04-bcfe-a95e811ee0d1" />
<img width="1096" height="724" alt="image" src="https://github.com/user-attachments/assets/cc89b38d-8bd9-4083-9a58-87f8918e10ee" />

- Ghidra näytti avautuvan kunnolla joten olen nyt ladannut Ghidran onnistuneesti virtuaalikoneelleni.

## b) rever-C

- Tässä tehtävässä avaan packd tiedoston Ghidrassa ja analysoin sitä.
- Aloitan luomalla uuden projektin Ghidrassa ja avaan packd tiedoston Ghidrassa.
<img width="299" height="72" alt="image" src="https://github.com/user-attachments/assets/9f37e601-e2c3-4625-96cf-cd289279f32d" />
<img width="553" height="315" alt="image" src="https://github.com/user-attachments/assets/2d639f14-1cf2-4066-9d2e-d0a8a8246ea4" />
<img width="541" height="177" alt="image" src="https://github.com/user-attachments/assets/8372dff0-0fc6-4b3e-be91-44ec89c49a74" />

- Painan yes ja sen jälkeen painan window ja valitsen defined strings jonka jälkeen nämä stringit tulee esille.
<img width="370" height="300" alt="image" src="https://github.com/user-attachments/assets/2c0ba5a6-c3a5-457c-98f1-e63c2b4eb47a" />

- Jos menen alimpaan proc/self/eze niin löydän FUN elikkä function kohdan, taisin löytää pääohjelman koska missään muualla ei ole funktiota. Avaan funktion.
<img width="952" height="253" alt="image" src="https://github.com/user-attachments/assets/f9a35674-4320-45ea-a6c9-6906dee22fa0" />
<img width="648" height="246" alt="image" src="https://github.com/user-attachments/assets/69bc0dec-25a6-4c9a-9741-f20e05733cd2" />

- Sieltä löytyy funktion jonka alla on toinen funktio, tämä voisi olla vaikka main joten nimeän sen uudestaan mainiksi.
<img width="184" height="82" alt="image" src="https://github.com/user-attachments/assets/eb7d826b-8f5a-474c-9993-a7c0e4778301" />

- Sen jälkeen hyppään seuraavaan funktioon joka on juuri viime funktion alla ja se avautuu tällein.
<img width="463" height="527" alt="image" src="https://github.com/user-attachments/assets/2a966798-3555-4f8c-993b-0243ebec8468" />

- Tässä vaiheessa en oikein ymmärrä koodia joten palaan tähän myöhemmin yritin etsiä internetistä selkoa että mitä tämä koodinpätkä voisi tarkoittaa enkä oikein löytänyt mitään. Jos en löydä vastausta tähän niin palaan asiaan myöhemmin.
- Olen yrittänyt löytää ratkaisua ongelmaan mutta Ghidra sovelluksena on minulle liian vieras ja mennyt liikaa aikaa joten jatkan seuraavaan tehtävään.

- Palattuani tähän myöhemmin 8.2.2026, näyttää siltä että Ghidran analyysi oli jotenkin ollut virheellinen itselläni että se ei ollut saanut kaikkia stringejä analysoituja.
<img width="411" height="332" alt="image" src="https://github.com/user-attachments/assets/6a7c56c9-b7f6-420b-9499-9181c61eb692" />

- Symbol treestä pitäisi löytyä enemmän funktioita mutta mistään ei löytynyt mitään joka viittaa main funktioon.


## c) If backwards

- Tässä tehtävässä minä yritän muuttaa ohjelman passtr sillein että väärät vastaukset antavat oikean vastauksen ja oikea antaa väärän vastauksen.
- Samat stepit kun viime tehtävässä, löydän main funktion ja avaan sen
<img width="638" height="350" alt="image" src="https://github.com/user-attachments/assets/6337431c-fc5b-4ee4-a721-8591650e2fdb" />
<img width="771" height="580" alt="image" src="https://github.com/user-attachments/assets/e8604fa2-5843-4feb-bb03-09fdd866b823" />

- Tämän jälkeen yritän internetistä löydettyä ratkaisua että vaihdan jnz -> jz käyttämällä patch instructionia. JNZ on siis osa binääristä joka tarkistaa että salasanan return on oikein, mutta jos sen vaihtaa JZ niin kaikki paitsi oikea vastaus palauttaa oikean vastauksen.
<img width="603" height="34" alt="image" src="https://github.com/user-attachments/assets/ba4ae5ee-9383-4352-958c-d0d5c0c84040" />
<img width="451" height="30" alt="image" src="https://github.com/user-attachments/assets/8768a6de-4a52-408f-ba1d-7515fc6d6a9b" />

- Tämän jälkeen painan ok ja tallenna ja sen pitäisi toimia.
<img width="778" height="98" alt="image" src="https://github.com/user-attachments/assets/79b53d38-1524-48fc-b095-e45c4c277262" />

- Noh ei toiminut, en tiedä miksi ei toiminut koska jos vaihdan jnz -> jz joka tekee funktiosta käänteisen Ghidrassa niin sen pitäisi toimia toistenpäin, samalla logiikalla kun !=0. Tämä olisi myös hyvä käydä läpi tunnilla miten saan oikean ratkaisun ja miksi oma ratkaisu ei toiminut. Yritin vielä googlettaa että miksi ei toiminut mutta kaiken etsimäni perusteella tämän pitäisi toimia.
- Hyvä puoli tästä oli että sain kiinni miten funktioita etsitään ja mistä kohdasta pitää editoida, en tiedä miksi oli niin vaikeaa löytää kohta edellisestä tehtävästä mutta tästä löytyi paremmin.

## d) Nora CrackMe

- Tässä vaiheessa jokaisen edelliseen tehtävään mennyt ihan tuhottomasti aikaa joten yritän vielä huomenna sunnuntaina 8.2.2026 tehdä lisää seuraavat tehtävät jos saisin Ghidrasta jotain kiinni.
- Noniin ja 8.2.2026 Palasin seuraaviin tehtäviin. Lataan Nora CrackMe kansion githubista.
<img width="750" height="23" alt="image" src="https://github.com/user-attachments/assets/2679f85c-ac8d-4fae-bb59-21f49227d018" />

## e) Nora CrackMe01

- Tässä tehtävässä yritän katsoa crackme01 binääriä.
- Aloitan ajamalla crackme01 ja katson mitä tapahtuu.
<img width="513" height="41" alt="image" src="https://github.com/user-attachments/assets/2339ecc2-286e-4c1e-a1f0-360d3a51c572" />

- En oikein tajua tästä vielä mitään joten menen avaamaan tiedoston Ghidrassa.
<img width="512" height="273" alt="image" src="https://github.com/user-attachments/assets/b3ee9b09-1630-42da-8d24-e679111e04ab" />
<img width="532" height="169" alt="image" src="https://github.com/user-attachments/assets/0087b8c7-e1b6-4c85-9ee7-508bfae5e8b6" />

- Heti kun avasin defined strings niin salasana hyppäsi heti esiin. Yritin sitä ja se toimi.
<img width="621" height="464" alt="image" src="https://github.com/user-attachments/assets/097c382f-56b6-4c03-849a-e50c53c7eaa6" />
<img width="603" height="42" alt="image" src="https://github.com/user-attachments/assets/91ef3cba-d5da-463b-b694-8de77f18f230" />

- Seuraavassa crackme01e binäärissä on sama juttu, pitää löytää salasana joten importaan sen taas Ghidraan.
<img width="626" height="463" alt="image" src="https://github.com/user-attachments/assets/a3006dee-4a82-4523-a62c-cc1724cebcf6" />
  
- Sama juttu tässäkin tehtävässä, tämä näyttää salasanalta joka näkyy jo strings vaiheessa.
<img width="672" height="97" alt="image" src="https://github.com/user-attachments/assets/efe27037-efd1-4625-ba4e-40b74724c647" />

- Ja se oli oikea vastaus. Nyt tehtävät alkaa rullaa koska ensimmäisessä tehtävässä ei mene tuntikausia ongelmankorjaukseen johon en loppujen lopulta edes löytänyt vastausta.

## f) Nora crackme02

- Sama juttu kun viime tehtävässä elikkä avaan Ghidrassa crackme02.
<img width="875" height="629" alt="image" src="https://github.com/user-attachments/assets/0e69660e-8d91-4ad9-9d65-b1212128d0ac" />

- Näen taas stringissä password1 joten kokeilen sitä ensimmäiseksi mutta jotenkin tuntuu että se ei ole oikein tällä kertaa.
<img width="612" height="39" alt="image" src="https://github.com/user-attachments/assets/a2febbb2-bbb1-4993-8df8-532de4fc5eb9" />

- Jep elikkä pitää yrittää löytää jotain muuta.
<img width="568" height="335" alt="image" src="https://github.com/user-attachments/assets/d83f9ca2-61e3-439a-a4c5-f7e59a9adb68" />

- Löydän tästä oikeasta vastauksesta xrefin joten seuraan sitä.
<img width="868" height="494" alt="image" src="https://github.com/user-attachments/assets/7108b6b9-e158-4b33-a0c8-0850c4509f75" />

- Löysin symbol treestä vasemmalta main koodipätkän josta löysin uVar3 pätkästä EAX kohdan. Se on hexabinäärimuodossa joten yritän muuntaa sen numeroiksi käyttäen hexabinäärimuunninta googlessa.
<img width="552" height="682" alt="image" src="https://github.com/user-attachments/assets/22ac1432-e256-4b07-aeb6-2e40ccd4398f" />

- Yritän tätä salasanana jos se vaikka toimisi.
<img width="660" height="39" alt="image" src="https://github.com/user-attachments/assets/c95748da-1b3e-4b9c-97cb-570051c45ff2" />

- Ei ollut oikein.

## Pohdinta

- Ghidra on erittäin vaikea ohjelma päästä käsiksi, mutta sen on täysin uusi minulle ja olen yrittänyt parhaani selvittää miten Ghidraa käytetään. Se on ollut isoin haaste ja aikaa mennyt paljon lukemiseen miten Ghidra toimii ja muut läksyt muista kursseista painanut myös.
- Tämä on ehdottomasti tehtävä johon aion palata koska en ole ollenkaan päässyt jyvälle Ghidra-sovelluksesta.
- Yritän vielä 8.2.2026 tehdä pari tehtävää.

## Lähteet

- Ghidra for reverse engineering: https://www.youtube.com/watch?v=oTD_ki86c9I
- Tero Karvinen. Application hacking: https://terokarvinen.com/application-hacking/
- Ghidra github: https://github.com/NationalSecurityAgency/ghidra

